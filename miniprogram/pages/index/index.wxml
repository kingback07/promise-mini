<!--miniprogram/pages/index/index.wxml-->
<view class="container">
  <!-- 顶部欢迎/用户信息区域 -->
  <view class="header">
    <text class="title">一言为定</text>
    <text class="subtitle">记录每一份承诺</text>
  </view>

  <!-- 承诺列表区域 -->
  <view class="promise-list">
    <block wx:if="{{loading}}">
      <view class="loading">加载中...</view>
    </block>
    
    <block wx:elif="{{promises.length === 0}}">
      <view class="empty-state">
        <image class="empty-icon" src="/images/empty.png" mode="aspectFit" wx:if="{{false}}"></image> <!-- 暂无图片 -->
        <text>暂无承诺，去新建一个吧</text>
      </view>
    </block>

    <block wx:else>
      <view class="promise-card" wx:for="{{promises}}" wx:key="_id" bindtap="goToDetail" data-id="{{item._id}}">
        <view class="card-header">
          <text class="card-title">{{item.title}}</text>
          <text class="card-status status-{{item.status}}">
            {{item.status === 0 ? '进行中' : (item.status === 1 ? '已完成' : '已失效')}}
          </text>
        </view>
        <view class="card-content">
          <text>{{item.content}}</text>
        </view>
        <view class="card-footer">
          <text class="date">截止: {{item.deadline || '无截止日期'}}</text>
        </view>
      </view>
    </block>
  </view>

  <!-- 悬浮添加按钮 -->
  <view class="fab-btn" bindtap="goToCreate">
    <text class="plus">+</text>
  </view>
</view>
